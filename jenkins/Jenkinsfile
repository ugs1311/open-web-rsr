pipeline {  
    agent any   
    stages {  
        stage('Clone') {  
            stesp { 
		  git 'https://github.com/rsrprojects/rsr-stocknewsapplication.git'   
            }  
        }  
        stage('Build Docker Image') {  
            steps {  
                script {  
                    def app = docker.build("rsrprojects/docker-rsr-hub:latest", "-f docker/Dockerfile .")  
                }  
            }  
        }  
        stage('Push Docker Image') {  
            steps {  
                script {  
                    docker.withRegistry('https://index.docker.io/v1/', 'dockerhub-credentials') {  
                        app.push()  
                    }  
                }  
            }  
        }  
        stage('Deploy to Kubernetes') {  
            steps {  
                script {  
                    sh 'kubectl apply -f k8s/deployment.yaml'  
                    sh 'kubectl apply -f k8s/service.yaml'  
                }  
            }  
        }  
    }  
    post {  
        success {  
            echo 'Pipeline completed successfully.'  
        }  
        failure {  
            echo 'Pipeline failed.'  
        }  
    }  
}
